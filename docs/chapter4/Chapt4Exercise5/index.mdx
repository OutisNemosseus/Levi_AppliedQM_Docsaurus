---
title: Chapter 4 - Exercise 5
sidebar_label: Chapter 4 - Exercise 5
---

# Chapter 4 - Exercise 5

> **Chapter 4**: Harmonic Oscillator
>
> ðŸ“Š 1 file(s) available

## Available Files


<div style={{
  border: '1px solid #e5e7eb',
  borderRadius: '8px',
  padding: '16px',
  marginBottom: '12px',
  backgroundColor: '#fafafa',
}}>
  <div style={{display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px'}}>
    <span style={{fontSize: '24px'}}>ðŸ“Š</span>
    <div>
      <strong style={{color: '#0076a8'}}>MATLAB</strong>
      <div style={{fontSize: '12px', color: '#666'}}>`Chapt4Exercise5.m`</div>
    </div>
  </div>
  <div style={{display: 'flex', gap: '8px', flexWrap: 'wrap'}}>
    <a
      href="./Chapt4Exercise5_matlab"
      style={{
        padding: '6px 12px',
        backgroundColor: '#0076a8',
        color: 'white',
        borderRadius: '4px',
        textDecoration: 'none',
        fontSize: '13px',
      }}
    >
      ðŸ“– View Details
    </a>
    <a
      href="/programs/matlab/Chapt4Exercise5/Chapt4Exercise5.m"
      download="Chapt4Exercise5.m"
      style={{
        padding: '6px 12px',
        backgroundColor: '#10b981',
        color: 'white',
        borderRadius: '4px',
        textDecoration: 'none',
        fontSize: '13px',
      }}
    >
      ðŸ“¥ Download
    </a>
    <a
      href="/programs/matlab/Chapt4Exercise5/Chapt4Exercise5.m"
      target="_blank"
      rel="noopener noreferrer"
      style={{
        padding: '6px 12px',
        backgroundColor: '#6b7280',
        color: 'white',
        borderRadius: '4px',
        textDecoration: 'none',
        fontSize: '13px',
      }}
    >
      ðŸ”— Open
    </a>
  </div>
</div>

## Inline Previews

### MATLAB - Chapt4Exercise5.m

```matlab title="Chapt4Exercise5.m"
%Chap4Exercise5.m%VCSEL mirror designclear;clf;% '1' is GaAs layer, '2' is AlAs layerwavelength=980e-9;  % center wavelength in metersd1=69.5e-9;         % thickness of dielectric with refractive n1 (GaAs layer)d2=82.3e-9;         % thickness of dielectric with refractive n2 (AlAs layer)d3=277.9e-9;        % thickness of dielectric with refractive n1 in center of pass-band filtern1=wavelength/d1/4; % 3.5 is refractive istep of GaAsn2=wavelength/d2/4; % 3.0 is refractive istep of AlAsistep=0;resolution=0.00005; % resolution in nmrange=[-100:1:-2 -1:resolution:1 1:1:100]*1e-9+wavelength; %wavelength scanning rangefor wavelength=rangeistep=istep+1;k0=2*pi/wavelength; %input from airk1=2*pi*n1/wavelength;k2=2*pi*n2/wavelength;% in EM, exp(-ikz) is considered positive propagation +z direction% Assuming light coming in perpendicularly from the lower side (-z) to upper size (+z)% A*exp(-ik1*z)+B*exp(ik1*z)=C*exp(-ik2*z)+D*exp(-ik2*z)% D0,D1,D2 are interface matrices% [D0]*[input from air]=[D1]*[output to n1],% [D1]*[input from n1]=[D2]*[output to n2]D0=[1 1    k0 -k0];D1=[1 1    k1 -k1];D2=[1 1    k2 -k2];    % P1,P2,P3 are propagation matrices% input from the below, output above material, [input from below]=[P]*[output above],P1=[exp(i*k1*d1) 0    0 exp(-i*k1*d1)];        P2=[exp(i*k2*d2) 0    0 exp(-i*k2*d2)];P3=[exp(i*k1*d3) 0           % for dielectric with refractive index n1 in center of    0 exp(-i*k1*d3)];        % passband filter % Solution = % [Input A;B]=inv(D0)*{D1*P1*inv(D1)*D2*P2*inv(D2)}*{2nd period}*{3rd}% *..*{defect,wider n1}*...*{D1*P1*inv(D1)*D2*P2*inv(D2)}*D0*[output C;D]G1=D1*P1*inv(D1)*D2*P2*inv(D2);   	% for period of lower mirrorG2=D2*P2*inv(D2)*D1*P1*inv(D1);   	% for period of upper mirrorlower=inv(D0)*(G1^25)*D1;         	% propagation through lower 25 layer-pairsupper=inv(D1)*(G2^25)*D0;         	% propagation through upper 25 layer-pairsTotal=lower*P3*upper;r(istep)=Total(2,1)/Total(1,1);    	% reflected electromagnetic fieldR(istep)=r(istep)*conj(r(istep));  	% total reflection intensity is r x r*lower_r(istep)=lower(2,1)/lower(1,1);lower_R(istep)=lower_r(istep)*conj(lower_r(istep));  % total reflectionupper_r(istep)=upper(2,1)/upper(1,1);upper_R(istep)=upper_r(istep)*conj(upper_r(istep));  % total reflectionend    %%% loop to next value of istepfigure(1);plot(range,lower_R);title(['Chapt4Exercise5a, Bragg mirror']);ylabel('Reflection');xlabel('Wavelength (m)');FWHM=size(find(R<max(R)/2),2)*resolution*1e-9  %accurate only when one peak in the rangefigure(2);plot(range,R);grid;title(['Chapt4Exercise5b, VCSEL mirror' ]);ylabel('Reflection');xlabel('Wavelength (m)');temp=['FWHM = '  num2str(FWHM) '  m'];text(980e-9, 0.5, temp);
```


---

*Program ID: `Chapt4Exercise5`*
