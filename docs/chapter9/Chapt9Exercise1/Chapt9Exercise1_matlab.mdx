---
title: Chapter 9 - Exercise 1 - MATLAB
sidebar_label: MATLAB Code
---

# Chapter 9 - Exercise 1 - MATLAB Code

<div style={{display: 'flex', gap: '12px', flexWrap: 'wrap', marginBottom: '24px'}}>

  <a href="/programs/matlab/Chapt9Exercise1/Chapt9Exercise1.m" download="Chapt9Exercise1.m"
    style={{padding: '10px 20px', backgroundColor: '#10b981', color: 'white', borderRadius: '6px', textDecoration: 'none', fontWeight: 'bold'}}>
    üì• Download .m
  </a>
  <a href="/programs/matlab/Chapt9Exercise1/Chapt9Exercise1.m" target="_blank" rel="noopener noreferrer"
    style={{padding: '10px 20px', backgroundColor: '#3b82f6', color: 'white', borderRadius: '6px', textDecoration: 'none', fontWeight: 'bold'}}>
    üîó Open Raw
  </a>
</div>

## Source Code

```matlab title="Chapt9Exercise1.m"
% Chapt9Exercise1.m% plot gain and spontaneous emission as function of photon energy% for carrier 10 different carrier densities% uses function mu.m and fermi.m% carrier density n(m-3), temperature kelvin(K)% clearclf;      echarge=1.6021764e-19;			%electron charge (C)   hbar=1.05457159e-34;				%planck's constant (J s)   c = 2.99792458e8;					%speed of light in vacuum (m s-1)   kB=8.61734e-5;						%Boltzmann constant (eV K-1)   epsilon0=8.8541878e-12;			%permittivity of free space (F m-1)    m0=9.109382e-31;					%bare electron mass (kg)   me=0.07*m0;							%effective electron mass (kg)   mhh=0.5*m0;							%effective heavy hole mass (kg)   mr=1/(1/me+1/mhh);				%reduced electron mass   rerr=1e-3;							%relative error      nr=3.3;								%refractive index   Eg=1.4								%band gap energy (eV)   kelvin=300.0;						%temperature (K)   kBT=kB*kelvin;						%thermal energy (eV)   beta=1/kBT;							%inverse thermal energy (eV-1)      for k=1:1:10         n=k*1.e18;							%carrier density (cm-3)	ncarrier=n*1e6;					%convert carrier density to (m-3)   muhh=mu(mhh,ncarrier,kelvin,rerr)	%call mu chemical potential function for holes (eV)   mue=mu(me,ncarrier,kelvin,rerr)   	%call mu chemical potential function for electrons (eV)   deltamu=mue+muhh							%difference in chemical potential (eV)         const=2.64e4;						%GaAs constant gives gain 330 cm-1 at n = 2e18 cm-3      deltae=0.001;   	for j=1:300      	Energy(j)=j*deltae;						%photon energy - Eg      	Ehh=(Energy(j))/(1+mhh/me);			%energy in hole band      	Ee=(Energy(j))/(1+me/mhh);				%energy in conduction band      	fhh=fermi(beta,Ehh,muhh);				%call Fermi function for holes      	fe=fermi(beta,Ee,mue);					%call Fermi function for electrons      	gain(j)=const*(Energy(j)^0.5)*(fe+fhh-1);      	rspon(j)=(const)*(Energy(j)^0.5)*(fe*fhh);   	end         figure(1)   hold on;   plot(Energy+Eg, gain);   xlabel('Photon energy, h\omega (eV)');   ylabel('Optical gain, g (cm^{-1})');	ttl=(['n_{min}=',num2str(1),'x10^{18} cm^{-3}, n_{max}=',num2str(k),'x10^{18} cm^{-3}, m_e=',num2str(me/m0),', m_{hh}=',num2str(mhh/m0),', T=',num2str(kelvin),' K, E_g=',num2str(Eg),' eV']);   title(ttl);   grid on;   hold off;   figure(2)   hold on;   plot(Energy+Eg,rspon,'r');   xlabel('Photon energy, h\omega (eV)');   ylabel('Spontaneous emission, rsp (arb.)');	title(ttl);   grid on;   end   hold off;      
```

---

[‚Üê Back to Chapter 9 - Exercise 1](./)
