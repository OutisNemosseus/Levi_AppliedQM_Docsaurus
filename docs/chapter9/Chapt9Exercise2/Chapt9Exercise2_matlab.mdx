---
title: Chapter 9 - Exercise 2 - MATLAB
sidebar_label: MATLAB Code
---

# Chapter 9 - Exercise 2 - MATLAB Code

<div style={{display: 'flex', gap: '12px', flexWrap: 'wrap', marginBottom: '24px'}}>

  <a href="/programs/matlab/Chapt9Exercise2/Chapt9Exercise2.m" download="Chapt9Exercise2.m"
    style={{padding: '10px 20px', backgroundColor: '#10b981', color: 'white', borderRadius: '6px', textDecoration: 'none', fontWeight: 'bold'}}>
    üì• Download .m
  </a>
  <a href="/programs/matlab/Chapt9Exercise2/Chapt9Exercise2.m" target="_blank" rel="noopener noreferrer"
    style={{padding: '10px 20px', backgroundColor: '#3b82f6', color: 'white', borderRadius: '6px', textDecoration: 'none', fontWeight: 'bold'}}>
    üîó Open Raw
  </a>
</div>

## Source Code

```matlab title="Chapt9Exercise2.m"
% Chapt9Exercise2.m% plot peak gain as function of carrier density from ncarrier1 to ncarrier2% uses function mu.m and fermi.m% carrier density n(m-3), temperature kelvin(K)% clearclf      echarge=1.6021764e-19;			%electron charge (C)   hbar=1.05457159e-34;				%planck's constant (J s)   c = 2.99792458e8;					%speed of light in vacuum (m s-1)   kB=8.61734e-5;						%Boltzmann constant (eV K-1)   epsilon0=8.8541878e-12;			%permittivity of free space (F m-1)    m0=9.109382e-31;					%bare electron mass (kg)   me=0.07*m0;							%effective electron mass (kg)   mhh=0.5*m0;							%effective hhole mass (kg)   mr=1/(1/me+1/mhh);				%reduced electron mass   rerr=1e-3;							%relative error      nr=3.3;								%refractive index   Eg=1.4								%band gap energy (eV)   	n1=1e18;								%minimum carrier density (cm-3)   ncarrier1=n1*1e6;					%convert carrier density to (m-3)   n2=1e19;								%maximum carrier density (cm-3)   ncarrier2=n2*1e6;					%convert carrier density to (m-3)   kelvin=300.0;						%temperature [K]   kBT=kB*kelvin;						%thermal energy [eV]   beta=1/kBT;							%inverse thermal energy (eV-1)      										%const=-echarge^2*hbar/(2*nr*c*m0^2*epsilon0)*((2*mr/hbar^2)^1.5)   const=2.64e4;						%put in constant that gives gain ~ 330 cm-1 gain at 2e18 cm-3      deltacarrier=(ncarrier2-ncarrier1)/100;   for k=1:100      ncarrier(k)=ncarrier1+(k-1)*deltacarrier;         muhh(k)=mu(mhh,ncarrier(k),kelvin,rerr);		%call mu chemical potential function for holes (eV)   mue(k) =mu(me, ncarrier(k),kelvin,rerr);   	%call mu chemical potential function for electrons (eV)   deltamu(k)=mue(k)+muhh(k);							%delta mu (eV)         deltae=0.001;										%1meV energy step      rspon=0;      peakgain(k)=-10000;      rspontotal(k)=0;   	for j=1:500      	Energy(j)=j*deltae;							%photon energy      	Ehh=Energy(j)/(1+mhh/me);					%energy in hole band      	Ee=Energy(j)/(1+me/mhh);					%energy in conduction band      	fhh=fermi(beta,Ehh,muhh(k));				%call Fermi function for holes      	fe=fermi(beta,Ee,mue(k));					%call Fermi function for electrons         gain(j)=const*(Energy(j)^0.5)*(fhh+fe-1);         rspon=rspon+(const*(Energy(j)^0.5))*(fe*fhh)*deltae;         if(gain(j) > peakgain(k))            peakgain(k)=gain(j);         end               end      rspontotal(k)=rspon;   end      figure(1)   plot(ncarrier./1e6, deltamu);   xlabel('Carrier concentration, n (cm^{-3})');   ylabel('Difference in chemical potential,  \Delta\mu (eV)');   ttl=(['Chapt9Exercise2, T = ',num2str(kelvin),' K,  m_e = ',num2str(me/m0),'m_0, m_{hh} = ',num2str(mhh/m0),'m_0 ']);   title(ttl);   grid on;      figure(2)   plot(ncarrier./1e6, peakgain);   xlabel('Carrier concentration, n (cm^{-3})');   ylabel('Peak optical gain, g (cm^{-1})');   title(ttl);   grid on;      figure(3)   plot(ncarrier./1e6, rspontotal);   xlabel('Carrier concentration, n (cm^{-3})');   ylabel('Total spontaneous emission, rsp _{total} (arb.)');   title(ttl);   grid on;            
```

---

[‚Üê Back to Chapter 9 - Exercise 2](./)
